<!DOCTYPE html>
<html lang="en">
<%- include('../partials/head', { cssFiles: ['messages.css', 'admin/dashboard.css'], scripts: [] }) %>

  <body>
    <%- include('../partials/navbar') %>

      <header class="admin-header">
        <h1 id="messages-heading"><%= typeof recipient_display !== 'undefined' ? recipient_display : (recipient || 'user') %></h1>
        <p class="subtitle">Conversation with <%= typeof recipient_display !== 'undefined' ? recipient_display : (recipient || 'user') %></p>
      </header>
      <main class="section" aria-labelledby="messages-heading">
        <div class="container container--narrow admin-panel">
        <a href="/admin/message-senders" class="link--button link" id="back-to-dashboard">
            <%- include('../icon', { name: 'back' }) %> Back to Messages
        </a>
          <section class="stack">
            <div id="messages-list" class="messages-list">
              <% if (!messages || !messages.length) { %>
                <div class="messages-empty muted">No messages yet.</div>
              <% } else { %>
                <% messages.forEach(function(m) { %>
                  <div class="message <%= m.is_from_user ? 'from-user' : 'from-server' %>">
                    <div class="message-header">
                      <time datetime="<%= m.created_at %>"><%= new Date(m.created_at).toLocaleString() %></time>
                      <% if (m.user_email) { %>
                        <div class="message-meta muted">From: <%= m.user_email %></div>
                      <% } %>
                    </div>
                    <div class="message-body"><%= m.body %></div>
                  </div>
                <% }); %>
              <% } %>
            </div>

            <form id="messages-form" class="messages-form" action="#" onsubmit="return false;">
              <input type="hidden" id="recipient" name="recipient" value="<%= typeof recipient !== 'undefined' ? recipient : '' %>" />
              <textarea id="messages-body" name="body" rows="3" placeholder="Write a message reply..."></textarea>
              <div class="messages-form-actions">
                <button class="primary" type="submit">Send Reply</button>
              </div>
            </form>

          </section>

        </div>
      </main>


      <%- include('../partials/footer') %>
  </body>

</html>
