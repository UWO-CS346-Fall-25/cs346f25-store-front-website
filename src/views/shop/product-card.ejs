<article class="card product" itemscope itemtype="https://schema.org/Product">
  <a class="product__link" href="<%= url %>" aria-label="<%= (product?.name || 'View product') %>">
    <figure class="product__media">
      <!-- square stage -->
      <div class="product__stage">
      <% if(product.image != undefined) { %>
        <% if(product.image.path != undefined) { %>
          <img class="product__img" src="<%= product.image.path %>"
            alt="<%= product?.alt || product?.name || 'Product image' %>" loading="lazy" decoding="async">
        <% } else if(product.image.external_url != undefined) { %>
          <img class="product__img" src="<%= product.image.external_url %>"
            alt="<%= product?.alt || product?.name || 'Product image' %>" loading="lazy" decoding="async">
        <% }%>
      <% }%>
      </div>
      <% if (product?.badge) { %>
        <figcaption class="product__badge">
          <%= product.badge %>
        </figcaption>
        <% } %>
    </figure>

    <div class="product__body">
      <h3 class="product__name" itemprop="name">
        <%= product?.name || 'Untitled Product' %>
      </h3>
      <p class="product__price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
        <span itemprop="priceCurrency" content="USD">$</span>
        <span itemprop="price">
          <%= price %>
        </span>
      </p>
    </div>

    <!-- Slide-up reveal on hover -->
    <div class="product__reveal" aria-hidden="true">
      <p class="product__blurb">
        <%= (product?.blurb || product?.description || 'Handmade with care.' ) %>
      </p>
      <p class="product__cta">View details â†’</p>
    </div>
  </a>
</article>